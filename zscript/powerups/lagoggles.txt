class SGDLightAmpGoggles : CustomInventory
{
	Default
	{
		Inventory.Amount 100;
		Inventory.MaxAmount 100;
		Inventory.Icon "ICON_NVG";
		Inventory.PickupMessage "$SGD_PU_LAGOGGLES";
		Inventory.ForbiddenTo "DemonizedPlayer";
		+INVENTORY.INVBAR;
	}

	States
	{
	Spawn:
		PVIS AB 6 BRIGHT;
		Loop;
	Pickup:
		TNT1 A 0 A_GiveInventory("GoggleTimer",4200);
		Stop;
	Use:	// Doing the toggle in the actor itself was clearly a far better idea than an ACS solution.
		TNT1 A 0 A_JumpIf(!FindInventory("GogglesActive"),"ToggleOn");
		TNT1 A 0 A_JumpIf(FindInventory("GogglesActive"),"ToggleOff");
		Fail;
	ToggleOn:
		TNT1 A 0 { if(CVar.FindCVar('sgd_visortogglesound').GetBool() == true) { A_PlaySound("visor/toggle"); }}
		TNT1 A 0 A_GiveInventory("LightAmpGogglesGiver");
		TNT1 A 0 A_GiveInventory("GogglesActive");
		TNT1 A 0 ACS_NamedExecute("GoggleTaker",0);
		Fail;
	ToggleOff:
		TNT1 A 0 { if(CVar.FindCVar('sgd_visortogglesound').GetBool() == true) { A_PlaySound("visor/toggle"); }}
		TNT1 A 0 A_TakeInventory("LightAmpGogglesGiver");
		TNT1 A 0 A_TakeInventory("GogglesActive");
		TNT1 A 0 ACS_NamedSuspend("GoggleTaker",0);
		Fail;
	}
}

class LightAmpGogglesGiver : PowerLightAmp
{
	Default { Powerup.Duration 0x7FFFFFFD; }
}
